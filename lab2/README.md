# Лабораторная работа №2. Вариант 7

## Выравнивание статистических распределений и проверка гипотез о законах распределения случайных величин

---

## Цель работы

По заданному интервальному статистическому ряду построить статистическое распределение экспериментальных данных в виде гистограммы, произвести ее выравнивание теоретической плотностью нормального распределения и проверить гипотезу о соответствии статистического и теоретического распределений.

---

## Теоретические основы

### 1. Статистическое распределение

**Статистическое распределение** — это соответствие между наблюдаемыми значениями случайной величины и их частотами (или относительными частотами).

Для непрерывных случайных величин используется **интервальный статистический ряд**, в котором область возможных значений разбивается на интервалы J₁, J₂, ..., Jₖ, и для каждого интервала подсчитывается число попаданий mₗ наблюдаемых значений.

**Статистическая вероятность** попадания в интервал Jₗ:
```
p*ₗ = mₗ / n
```
где n — общее число наблюдений.

### 2. Гистограмма

**Гистограмма** — это столбчатая диаграмма, в которой:
- по оси абсцисс откладываются интервалы значений случайной величины;
- по оси ординат откладывается плотность частоты: **h(x) = p*ₗ / Δₗ**, где Δₗ — ширина интервала.

Площадь каждого прямоугольника равна относительной частоте p*ₗ, а площадь всей гистограммы равна 1.

Гистограмма дает наглядное представление о характере распределения случайной величины и позволяет визуально оценить его форму.

### 3. Нормальное распределение

**Нормальное (гауссово) распределение** — один из важнейших типов непрерывных распределений, которое возникает в задачах, где случайная величина является результатом действия большого числа независимых случайных факторов.

Плотность вероятности нормального распределения:
```
f(x) = (1 / (σ√(2π))) × exp(-(x - μ)² / (2σ²))
```

Параметры:
- **μ** — математическое ожидание (центр распределения)
- **σ** — среднеквадратическое отклонение (мера разброса)
- **σ²** — дисперсия

Свойства нормального распределения:
- Симметрично относительно μ
- Колоколообразная форма
- Максимум плотности достигается в точке x = μ
- При x → ±∞ плотность стремится к нулю
- Правило трёх сигм: практически все значения (99.7%) лежат в интервале [μ - 3σ, μ + 3σ]

### 4. Метод моментов

**Метод моментов** — метод оценки неизвестных параметров распределения по выборочным данным.

Для нормального распределения:

**Выборочное среднее** (оценка математического ожидания):
```
μ̂ = (1/n) × Σ(xᵢ × mᵢ)
```
где xᵢ — середины интервалов.

**Выборочная дисперсия**:
```
σ̂² = (1/n) × Σ((xᵢ - μ̂)² × mᵢ)
```

**Исправленная (несмещенная) оценка СКО**:
```
s = √(n/(n-1)) × σ̂
```

Исправленная оценка используется для более точного оценивания параметров генеральной совокупности по выборке.

### 5. Критерий χ² (хи-квадрат) Пирсона

**Критерий χ² К. Пирсона** — статистический критерий для проверки гипотезы о соответствии эмпирического распределения теоретическому.

**Нулевая гипотеза H₀**: экспериментальные данные подчиняются предполагаемому теоретическому распределению (в данном случае — нормальному).

**Статистика критерия**:
```
χ²ₙₐᵦₗ = Σ((mₗ - n×P(Jₗ))² / (n×P(Jₗ)))
```
где:
- mₗ — наблюдаемые частоты
- P(Jₗ) — теоретические вероятности попадания в интервал Jₗ
- n×P(Jₗ) — теоретические (ожидаемые) частоты

**Условие применимости**: все теоретические частоты должны быть не менее 5 (n×P(Jₗ) ≥ 5). При нарушении этого условия соседние интервалы объединяются.

**Число степеней свободы**:
```
k = r - 1 - s
```
где:
- r — число интервалов после объединения
- s — число оцененных параметров (для нормального распределения s = 2: μ и σ)

**Правило принятия решения**:
- Если χ²ₙₐᵦₗ < χ²ₖᵣᵢₜ(k, α), то гипотеза H₀ **принимается**
- Если χ²ₙₐᵦₗ ≥ χ²ₖᵣᵢₜ(k, α), то гипотеза H₀ **отвергается**

где χ²ₖᵣᵢₜ(k, α) — критическое значение распределения χ² с k степенями свободы при уровне значимости α.

**Уровень значимости α** — вероятность ошибки первого рода (отвергнуть верную гипотезу). В данной работе α = 0.05 (5%).

**p-value** — вероятность получить наблюдаемое или более экстремальное значение статистики при условии, что нулевая гипотеза верна. Если p-value > α, гипотеза принимается.

---

## Исходные данные (Вариант 7)

| Интервал Jₗ        | Число попаданий mₗ |
|--------------------|--------------------|
| [-0.5; 0.0)        | 2                  |
| [0.0; 0.5)         | 10                 |
| [0.5; 1.0)         | 29                 |
| [1.0; 1.5)         | 30                 |
| [1.5; 2.0)         | 21                 |
| [2.0; 2.5)         | 7                  |
| [2.5; 3.0)         | 1                  |

**Общее число наблюдений**: n = 100
**Уровень значимости**: α = 0.05 (для нечетных вариантов)

---


## Инструкция по запуску

### Требования
- Python 3.8 или выше
- Библиотеки: numpy, scipy, matplotlib

### Установка зависимостей

```bash
cd lab2

# Создание виртуального окружения (если не создано)
python3 -m venv venv

# Активация виртуального окружения
source venv/bin/activate  # для Linux/macOS
# или
venv\Scripts\activate     # для Windows

# Установка зависимостей
pip install -r requirements.txt
```

### Запуск программы

```bash
python lab2.py
```

### Результаты работы

После выполнения программа:
1. Выведет в консоль подробные результаты всех вычислений
2. Создаст файл `lab2_results.png` с визуализацией результатов (4 графика):
   - Гистограмма и теоретическая плотность
   - Сравнение наблюдаемых и теоретических частот
   - Эмпирическая и теоретическая функции распределения
   - Результаты проверки гипотезы

---

## Структура проекта

```
lab2/
├── lab2.py                  # Основной файл программы
├── requirements.txt         # Зависимости проекта
├── README.md               # Документация (этот файл)
├── oed_2lab.pdf            # Задание лабораторной работы
├── lab2_results.png        # Графики результатов (создается при запуске)
└── venv/                   # Виртуальное окружение (не включается в git)
```

---

**Автор**: Вариант 7
**Дата**: 2026
